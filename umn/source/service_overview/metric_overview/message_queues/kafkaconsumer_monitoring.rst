:original_name: apm_01_0061.html

.. _apm_01_0061:

KafkaConsumer Monitoring
========================

This section describes the types, names, and meanings of KafkaConsumer metrics collected by APM.

.. table:: **Table 1** KafkaConsumer monitoring collection parameters

   +----------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+----------------------------------------------------------------------------+
   | Parameter                              | Data Type | Application Type | Default | Supported Start Agent Version | Supported End Agent Version | Description                                                                |
   +========================================+===========+==================+=========+===============================+=============================+============================================================================+
   | Kafka Slow Request Threshold           | integer   | JAVA             | 800     | 2.1.14                        | ``-``                       | The sampling ratio will increase if the slow request threshold is crossed. |
   +----------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+----------------------------------------------------------------------------+
   | Kafka Consumption Method Configuration | obj_array | JAVA             | ``-``   | 2.1.14                        | ``-``                       | Kafka consumption method configuration                                     |
   +----------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+----------------------------------------------------------------------------+

.. table:: **Table 2** KafkaConsumer metrics

   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | Category                                                                | Metric               | Name                 | Description                                         | Unit  | Data Type | Default Aggregation Mode |
   +=========================================================================+======================+======================+=====================================================+=======+===========+==========================+
   | Topic (**topic**: Kafka topic monitoring data)                          | id                   | id                   | Client ID and IP address                            | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | topic                | topic                | Kafka topic name                                    | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | bytesConsumedRate    | bytesConsumedRate    | Number of bytes consumed per second                 | Byte  | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchSizeAvg         | fetchSizeAvg         | Average number of bytes fetched for a request       | Byte  | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchSizeMax         | fetchSizeMax         | Maximum number of bytes fetched for a request       | Byte  | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsConsumedRate  | recordsConsumedRate  | Number of messages consumed per second              | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsPerRequestAvg | recordsPerRequestAvg | Average number of messages of a single request      | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | seqIds               | seqIds               | Sequence number generated by the producer           | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordConsumedTotal  | recordConsumedTotal  | Total number of consumption times                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | bytesConsumedTotal   | bytesConsumedTotal   | Total number of bytes that have been consumed       | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | Fetch monitoring (**fetch**: Kafka fetch monitoring data)               | id                   | id                   | Client ID and IP address                            | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | bytesConsumedRate    | bytesConsumedRate    | Number of bytes consumed per second                 | Byte  | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchLatencyAvg      | fetchLatencyAvg      | Average request latency                             | ms    | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchLatencyMax      | fetchLatencyMax      | Maximum request latency                             | ms    | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchRate            | fetchRate            | Number of requests per second                       | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchSizeAvg         | fetchSizeAvg         | Average number of bytes fetched for a request       | Byte  | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | fetchSizeMax         | fetchSizeMax         | Maximum number of bytes fetched for a request       | Byte  | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsConsumedRate  | recordsConsumedRate  | Number of messages consumed per second              | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsLagMax        | recordsLagMax        | Maximum number of accumulated messages              | ``-`` | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsPerRequestAvg | recordsPerRequestAvg | Average number of messages of a single request      | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | seqIds               | seqIds               | Sequence number generated by the producer           | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordConsumedTotal  | recordConsumedTotal  | Total number of consumption times                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | bytesConsumedTotal   | bytesConsumedTotal   | Total number of bytes that have been consumed       | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | Partition (**partition**: Kafka partition data)                         | id                   | id                   | Client ID and IP address                            | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | partition            | partition            | Kafka partition name                                | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsLag           | recordsLag           | Number of accumulated messages                      | ``-`` | INT       | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsLagAvg        | recordsLagAvg        | Average number of accumulated messages              | ``-`` | INT       | AVG                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsLagMax        | recordsLagMax        | Maximum number of accumulated messages              | ``-`` | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | seqIds               | seqIds               | Sequence number generated by the producer           | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | Kafka consumption method monitoring (**consumer**)                      | method               | method               | Consumption method                                  | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | concurrentMax        | concurrentMax        | Maximum concurrency                                 | ``-`` | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | errorCount           | errorCount           | Number of errors                                    | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | invokeCount          | invokeCount          | Number of calls                                     | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | lastError            | lastError            | Error details                                       | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | maxTime              | maxTime              | Maximum response time in a collection period        | ``-`` | INT       | MAX                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range1               | range1               | Number of requests with 0-10 ms response time       | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range2               | range2               | Number of requests with 10-100 ms response time     | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range3               | range3               | Number of requests with 100-500 ms response time    | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range4               | range4               | Number of requests with 500-1000 ms response time   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range5               | range5               | Number of requests with 1-10s response time         | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | range6               | range6               | Number of requests with more than 10s response time | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | totalTime            | totalTime            | Total response time                                 | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | KafkaConsumer summary (**total**)                                       | recordConsumedTotal  | recordConsumedTotal  | Total number of consumption times                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | bytesConsumedTotal   | bytesConsumedTotal   | Total number of bytes that have been consumed       | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | recordsLag           | recordsLag           | Total number of messages that have been accumulated | ``-`` | INT       | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   | Exception (**exception**: exception statistics about Kafka consumption) | causeType            | causeType            | Exception class                                     | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | exceptionType        | exceptionType        | Exception class                                     | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | count                | count                | Number of exceptions                                | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | message              | message              | Exception message                                   | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
   |                                                                         | stackTrace           | stackTrace           | Exception stack                                     | ``-`` | CLOB      | LAST                     |
   +-------------------------------------------------------------------------+----------------------+----------------------+-----------------------------------------------------+-------+-----------+--------------------------+
