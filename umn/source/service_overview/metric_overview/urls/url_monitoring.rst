:original_name: apm_01_0052.html

.. _apm_01_0052:

URL Monitoring
==============

This section describes the types, names, and meanings of URL metrics collected by APM.

.. table:: **Table 1** Collection parameters for URL monitoring

   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                            | Data Type | Application Type | Default | Supported Start Agent Version | Supported End Agent Version | Description                                                                                                                                                                                                   |
   +======================================+===========+==================+=========+===============================+=============================+===============================================================================================================================================================================================================+
   | Key for Header Value Interception    | array     | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Key based on which header value content is to be intercepted                                                                                                                                                  |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Key for Parameter Value Interception | array     | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Key based on which parameter value content is to be intercepted                                                                                                                                               |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Key for Cookie Value Interception    | array     | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Key based on which cookie value content is to be intercepted                                                                                                                                                  |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | URL Collection Configuration         | obj_array | JAVA             | ``-``   | 2.0.0                         | ``-``                       | URL collection configuration, based on which RESTful URLs are normalized. There are four modes: "startwith", "endwith", "include", and "regex".                                                               |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Blocklist Configuration              | obj_array | JAVA             | ``-``   | 2.0.0                         | ``-``                       | URLs that match the specified rule will not be collected. There are four modes: "startwith", "endwith", "include", and "regex".                                                                               |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Service Code Length                  | integer   | JAVA             | 0       | 2.0.0                         | ``-``                       | Maximum length of the body content to be collected for service code parsing                                                                                                                                   |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Key for Service Code Interception    | array     | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Specify a key. Then the system parses the key in the body (JSON) and obtains the service status code based on the key.                                                                                        |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Normal Service Code                  | array     | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Normal service code range. If a service code is not within this range, the corresponding trace is regarded as an error trace.                                                                                 |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Slow Request Threshold               | integer   | JAVA             | 800     | 2.0.0                         | ``-``                       | Slow request threshold. If the threshold is crossed, the URL is regarded as a slow URL. In that case, the trace sampling ratio will be increased by default.                                                  |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | URL Configuration                    | obj_array | JAVA             | ``-``   | 2.0.0                         | ``-``                       | Configure the slow request threshold and sampling ratio for each URL separately. The following sampling policies can be set: percentage sampling, fixed-quantity sampling per minute, and automatic sampling. |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Error Code                           | radio     | JAVA             | 500     | 2.0.0                         | ``-``                       | Status codes that are counted as errors                                                                                                                                                                       |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Auto URL Normalization               | radio     | JAVA             | false   | 2.3.11                        | ``-``                       | Whether the URL will be automatically normalized                                                                                                                                                              |
   +--------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 2** URL metrics

   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   | Category                                                                                        | Metric           | Name             | Description                                                       | Unit  | Data Type | Default Aggregation Mode |
   +=================================================================================================+==================+==================+===================================================================+=======+===========+==========================+
   | Summary (**total**: URL call statistics summary)                                                | errorCount       | errorCount       | Total number of errors                                            | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | invokeCount      | invokeCount      | Total number of calls                                             | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | totalTime        | totalTime        | Total response time                                               | ms    | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | satisfiedCount   | satisfiedCount   | Number of satisfied requests                                      | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | toleratingCount  | toleratingCount  | Number of tolerable requests                                      | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   | Status code (**statuscode**: APM counts URL call statistics based on the status code returned.) | code             | code             | Status code                                                       | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | count            | count            | Number of times that the status code has occurred                 | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | url              | url              | Sample URL which returns the status code in a collection period   | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   | URL monitoring (**url**: APM counts URL call statistics by URL.)                                | url              | URL              | Request URL                                                       | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | method           | method           | Request HTTP method                                               | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | concurrentMax    | concurrentMax    | Maximum concurrency of the URL                                    | ``-`` | INT       | MAX                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | errorCount       | errorCount       | URL call errors                                                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | invokeCount      | invokeCount      | Number of times that the URL is called                            | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | lastError        | lastError        | Error details                                                     | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | maxTime          | maxTime          | Maximum response time of the URL in a collection period           | ms    | INT       | MAX                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | maxTimeNativeUrl | maxTimeNativeUrl | Slowest URL in the collection period                              | ``-`` | STRING    | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | runningCount     | runningCount     | Number of tasks that are being executed at the time of collection | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range1           | range1           | Number of requests with 0-10 ms response time                     | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range2           | range2           | Number of requests with 10-100 ms response time                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range3           | range3           | Number of requests with 100-500 ms response time                  | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range4           | range4           | Number of requests with 500-1000 ms response time                 | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range5           | range5           | Number of requests with 1-10s response time                       | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | range6           | range6           | Number of requests with response time longer than 10s             | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | totalTime        | totalTime        | Total response time                                               | ms    | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | isRoot           | isRoot           | Whether the span is a root span                                   | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | satisfiedCount   | satisfiedCount   | Number of satisfied requests                                      | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | toleratingCount  | toleratingCount  | Number of tolerable requests                                      | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   | Cluster call (**user**: APM counts URL call statistics based on the cluster ID of the caller.)  | clusterId        | clusterId        | Cluster ID of the caller                                          | ``-`` | ENUM      | LAST                     |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | invokeCount      | invokeCount      | Number of times the cluster is called                             | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | total1xxCount    | total1xxCount    | Number of times that a 1xx status code was returned               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | total2xxCount    | total2xxCount    | Number of times that a 2xx status code was returned               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | total3xxCount    | total3xxCount    | Number of times that a 3xx status code was returned               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | total4xxCount    | total4xxCount    | Number of times that a 4xx status code was returned               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | total5xxCount    | total5xxCount    | Number of times that a 5xx status code was returned               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | totalTime        | totalTime        | Total response time for calling the cluster                       | ms    | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                                 | errorCount       | errorCount       | Number of times that the cluster fails to be called               | ``-`` | INT       | SUM                      |
   +-------------------------------------------------------------------------------------------------+------------------+------------------+-------------------------------------------------------------------+-------+-----------+--------------------------+
