:original_name: apm_01_0035.html

.. _apm_01_0035:

ClickHouse Database
===================

This section describes the types, names, and meanings of ClickHouse database metrics collected by APM.

.. table:: **Table 1** ClickHouse database collection parameters

   +---------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+-------------------------------------------------------+
   | Parameter                             | Data Type | Application Type | Default | Supported Start Agent Version | Supported End Agent Version | Description                                           |
   +=======================================+===========+==================+=========+===============================+=============================+=======================================================+
   | Collect Original SQL Statement or Not | radio     | JAVA             | false   | 2.0.0                         | ``-``                       | Whether to collect and report original SQL statements |
   +---------------------------------------+-----------+------------------+---------+-------------------------------+-----------------------------+-------------------------------------------------------+

.. table:: **Table 2** ClickHouse database metrics

   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   | Category                                                                          | Metric          | Name            | Description                                                                | Unit  | Data Type | Default Aggregation Mode |
   +===================================================================================+=================+=================+============================================================================+=======+===========+==========================+
   | Database connection (**connection**: APM counts SQL call statistics by database.) | db              | db              | Database name                                                              | ``-`` | ENUM      | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | createdCount    | createdCount    | Number of connections created by the database                              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | currentCount    | currentCount    | Current number of connections of the database                              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | destroyedCount  | destroyedCount  | Number of the database's connections that have been destroyed              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | errorCount      | errorCount      | Number of errors that the database encounters                              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | invokeCount     | invokeCount     | Number of times that the database is called                                | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | maxTime         | maxTime         | Maximum response time of the database                                      | ``-`` | INT       | MAX                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range1          | range1          | Number of requests with 0-10 ms response time                              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range2          | range2          | Number of requests with 10-100 ms response time                            | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range3          | range3          | Number of requests with 100-200 ms response time                           | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range4          | range4          | Number of requests with 200-1000 ms response time                          | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range5          | range5          | Number of requests with 1-10s response time                                | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range6          | range6          | Number of requests with response time longer than 10s                      | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | readRowCount    | readRowCount    | Number of rows read from the database                                      | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | updatedRowCount | updatedRowCount | Number of rows updated in the database                                     | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | totalTime       | totalTime       | Total response time of the database                                        | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | slowestSql      | slowestSql      | Slowest SQL statement of the database in the collection period             | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   | Exception (**exception**: exception statistics about SQL calls)                   | causeType       | causeType       | Exception class                                                            | ``-`` | ENUM      | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | exceptionType   | exceptionType   | Exception type                                                             | ``-`` | ENUM      | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | count           | count           | Number of exceptions                                                       | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | message         | message         | Exception message                                                          | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | sql             | sql             | SQL statement that encounters an exception                                 | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | stackTrace      | stackTrace      | Exception stack information                                                | ``-`` | CLOB      | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   | Version (**version**: ClickHouse package version)                                 | version         | version         | Driver package version                                                     | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   | SQL monitoring (**sql**: APM counts call statistics by SQL.)                      | sql             | sql             | Unique ID of the SQL statement, which is used for alarm configuration      | ``-`` | ENUM      | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | concurrentMax   | concurrentMax   | Maximum concurrency of the SQL statement                                   | ``-`` | INT       | MAX                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | errorCount      | errorCount      | Number of errors that the SQL statement encounters                         | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | errorTraceId    | errorTraceId    | ID of the trace that encounters an error in a collection period            | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | invokeCount     | invokeCount     | Number of times that the SQL statement is called                           | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | lastError       | lastError       | SQL error information                                                      | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | maxTime         | maxTime         | Maximum response time of the SQL statement                                 | ``-`` | INT       | MAX                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | readRowCount    | readRowCount    | Number of read rows of the SQL statement                                   | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | runningCount    | runningCount    | Number of SQL statements that are being executed at the time of collection | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | slowTraceId     | slowTraceId     | ID of the slowest trace in a collection period                             | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | sqlString       | sqlString       | SQL statement                                                              | ``-`` | STRING    | LAST                     |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | totalTime       | totalTime       | Total response time                                                        | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | updatedRowCount | updatedRowCount | Number of updated rows of the SQL statement                                | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range1          | range1          | Number of requests with 0-10 ms response time                              | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range2          | range2          | Number of requests with 10-100 ms response time                            | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range3          | range3          | Number of requests with 100-200 ms response time                           | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range4          | range4          | Number of requests with 200-1000 ms response time                          | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range5          | range5          | Number of requests with 1-10s response time                                | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | range6          | range6          | Number of requests with response time longer than 10s                      | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   | Summary (**total**: summary about SQL statement call statistics)                  | invokeCount     | invokeCount     | Total number of calls                                                      | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | errorCount      | errorCount      | Total number of errors                                                     | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | readRowCount    | readRowCount    | Total number of read rows                                                  | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | totalTime       | totalTime       | Total response time                                                        | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
   |                                                                                   | updatedRowCount | updatedRowCount | Total number of updated rows                                               | ``-`` | INT       | SUM                      |
   +-----------------------------------------------------------------------------------+-----------------+-----------------+----------------------------------------------------------------------------+-------+-----------+--------------------------+
